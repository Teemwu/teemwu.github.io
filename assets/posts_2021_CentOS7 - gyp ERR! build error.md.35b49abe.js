import{_ as c,c as r,a as n,w as D,b as l,d as y,e as C,r as o,o as i}from"./app.caa71a2c.js";const v=JSON.parse('{"title":"CentOS7 - \\"gyp ERR! build error\\"","description":"","frontmatter":{"title":"CentOS7 - \\"gyp ERR! build error\\"","author":"teemwu","date":"2021/04/20 11:23","isPublished":true,"categories":["报错","服务器"],"tags":["centos7"],"wordCount":514},"headers":[{"level":1,"title":"CentOS7 - \\"gyp ERR! build error\\"","slug":"centos7-gyp-err-build-error","link":"#centos7-gyp-err-build-error","children":[{"level":2,"title":"起因","slug":"起因","link":"#起因","children":[]},{"level":2,"title":"解决方法一","slug":"解决方法一","link":"#解决方法一","children":[]},{"level":2,"title":"解决方法二","slug":"解决方法二","link":"#解决方法二","children":[{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}]}]}],"relativePath":"posts/2021/CentOS7 - gyp ERR! build error.md","lastUpdated":1675321729000}'),A={name:"posts/2021/CentOS7 - gyp ERR! build error.md"},F=l("h1",{id:"centos7-gyp-err-build-error",tabindex:"-1"},[y('CentOS7 - "gyp ERR! build error" '),l("a",{class:"header-anchor",href:"#centos7-gyp-err-build-error","aria-hidden":"true"},"#")],-1),d=C(`<h2 id="起因" tabindex="-1">起因 <a class="header-anchor" href="#起因" aria-hidden="true">#</a></h2><p>将本地运行完好的项目推送到服务器端进行自动打包部署，运行 “npm install“ 进行包安装，提示一大堆 “gyp ...&quot; 的报错，记得之前 Windows 上报此错误是需要安装 c++ 相关的运行套件，而在 CentOS7 上则需要安装 gcc （一个驱动程序，根据代码的后缀名来判断调用c编译器还是c++编译器 (g++)）,正常情况下 CentOS7 是自带 gcc 的，之所以运行报错，是因为 gcc 版本太低了，或者说我们的项目相关依赖需要的 gcc 版本太高了。</p><h2 id="解决方法一" tabindex="-1">解决方法一 <a class="header-anchor" href="#解决方法一" aria-hidden="true">#</a></h2><p>降低 node 版本，“npm install” 进行依赖安装时，node 会进行代相关码编译，其中过高的 node 版本对 gcc 的版本要求就更高，所以可以试下降低 node 的版本，实测中 node 版本从 15.x 降到 14.x 解决问题。</p><h2 id="解决方法二" tabindex="-1">解决方法二 <a class="header-anchor" href="#解决方法二" aria-hidden="true">#</a></h2><p>更新 gcc 的版本，依次执行如下命令：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 安装centos-release-scl</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo yum install centos</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">release</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">scl</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 安装devtoolset，8.x 版本</span></span>
<span class="line"><span style="color:#A6ACCD;">sudo yum install devtoolset</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">gcc</span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 激活对应的 devtoolset</span></span>
<span class="line"><span style="color:#A6ACCD;">scl enable devtoolset</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">8</span><span style="color:#A6ACCD;"> bash</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 查看当前 gcc 版本</span></span>
<span class="line"><span style="color:#A6ACCD;">gcc </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">v</span></span>
<span class="line"></span></code></pre></div><p>至此，重新执行 “npm install” ，应该可以正常安装了。 需要注意的是上面的操作只限当前会话，如若需要重启后继续使用，则需要执行以下配置：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 启用指定版本 devtoolset</span></span>
<span class="line"><span style="color:#A6ACCD;">source </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">opt</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rh</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">devtoolset</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">enable</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 打开开机自启执行文件，将上一个命令添加到 rc.local 末尾</span></span>
<span class="line"><span style="color:#A6ACCD;">vi </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">local</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 如果遇到权限问题，可执行以下进行赋权后再操作</span></span>
<span class="line"><span style="color:#A6ACCD;">chmod </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">x </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">etc</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">d</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">local</span></span>
<span class="line"></span></code></pre></div><p>如果不想每次都 enable 来指定版本的话，可以尝试替换掉旧版本 gcc，具体如下：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">mv </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">gcc </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">gcc</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">4.8</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ln </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">opt</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rh</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">devtoolset</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">gcc </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">gcc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">mv </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">++-</span><span style="color:#F78C6C;">4.8</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">ln </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">s </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">opt</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">rh</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">devtoolset</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">8</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">usr</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">++</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">gcc </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">version</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">++</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">version</span></span>
<span class="line"></span></code></pre></div><h3 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-hidden="true">#</a></h3><ul><li><a href="https://www.cnblogs.com/jixiaohua/p/11732225.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/jixiaohua/p/11732225.html</a></li></ul>`,13);function u(s,a,h,g,b,_){const p=o("articleMeta"),e=o("ClientOnly");return i(),r("div",null,[F,n(e,null,{default:D(()=>[n(p,{modelValue:s.$frontmatter,"onUpdate:modelValue":a[0]||(a[0]=t=>s.$frontmatter=t)},null,8,["modelValue"])]),_:1}),d])}const f=c(A,[["render",u]]);export{v as __pageData,f as default};
