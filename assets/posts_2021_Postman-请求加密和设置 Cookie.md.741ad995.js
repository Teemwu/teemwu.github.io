import{_ as r,G as n,o as c,c as i,L as o,w as D,k as l,a as y,U as F}from"./chunks/framework.6f6e9089.js";const C="/assets/2021012910190.0d666fa7.png",A="/assets/2021012910191.1f1dfb37.png",b=JSON.parse('{"title":"Postman-请求加密和设置 Cookie","description":"","frontmatter":{"title":"Postman-请求加密和设置 Cookie","author":"teemwu","date":"2021/01/29 10:19","isPublished":true,"categories":["工具"],"tags":["postman"],"wordCount":167},"headers":[{"level":1,"title":"Postman-请求加密和设置 Cookie","slug":"postman-请求加密和设置-cookie","link":"#postman-请求加密和设置-cookie","children":[{"level":3,"title":"请求加密","slug":"请求加密","link":"#请求加密","children":[]},{"level":3,"title":"设置 Cookie","slug":"设置-cookie","link":"#设置-cookie","children":[]},{"level":3,"title":"参考","slug":"参考","link":"#参考","children":[]}]}],"relativePath":"posts/2021/Postman-请求加密和设置 Cookie.md","filePath":"posts/2021/Postman-请求加密和设置 Cookie.md","lastUpdated":1690513373000}'),d={name:"posts/2021/Postman-请求加密和设置 Cookie.md"},m=l("h1",{id:"postman-请求加密和设置-cookie",tabindex:"-1"},[y("Postman-请求加密和设置 Cookie "),l("a",{class:"header-anchor",href:"#postman-请求加密和设置-cookie","aria-label":'Permalink to "Postman-请求加密和设置 Cookie"'},"​")],-1),k=F(`<h3 id="请求加密" tabindex="-1">请求加密 <a class="header-anchor" href="#请求加密" aria-label="Permalink to &quot;请求加密&quot;">​</a></h3><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">/**</span></span>
<span class="line"><span style="color:#A6ACCD;"> * Pre-request Script</span></span>
<span class="line"><span style="color:#A6ACCD;"> */</span></span>
<span class="line"><span style="color:#A6ACCD;">const </span><span style="color:#F07178;">md5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> CryptoJS.MD5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">pm.environment.set(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">sign</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, md5(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">要加密的字符串</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">).toString())</span></span>
<span class="line"><span style="color:#A6ACCD;">pm.environment.set(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">timestamp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">时间戳</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>设置完环境变量后即可在 headers 中使用，如下图 <img src="`+C+`" alt=""></p><h3 id="设置-cookie" tabindex="-1">设置 Cookie <a class="header-anchor" href="#设置-cookie" aria-label="Permalink to &quot;设置 Cookie&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/**</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * Pre-request Script</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> cookieJar </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">cookies</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">jar</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> domain </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> pm</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">request</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">host</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">cookieJar</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;">(domain</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cookieName</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cookieValue</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">error</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">cookie</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">error</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">An error occurred: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">error</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">Cookie saved: </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">cookie</span><span style="color:#89DDFF;">}\`</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>需要注意的是，设置 cookie 需要开启域名白名单，如下图 <img src="`+A+'" alt=""></p><h3 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h3><ul><li><a href="https://learning.postman.com/docs/sending-requests/cookies/" target="_blank" rel="noreferrer">Using cookies</a></li><li><a href="https://github.com/postmanlabs/postman-app-support/issues/9253" target="_blank" rel="noreferrer">CookieStore: programmatic access to &quot;127.0.0.1&quot; is denied </a></li></ul>',8);function u(s,a,h,_,f,g){const e=n("articleMeta"),p=n("ClientOnly");return c(),i("div",null,[m,o(p,null,{default:D(()=>[o(e,{modelValue:s.$frontmatter,"onUpdate:modelValue":a[0]||(a[0]=t=>s.$frontmatter=t)},null,8,["modelValue"])]),_:1}),k])}const E=r(d,[["render",u]]);export{b as __pageData,E as default};
