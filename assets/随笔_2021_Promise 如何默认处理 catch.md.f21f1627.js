import{_ as s,c as a,o as n,a as l}from"./app.cf79d8dc.js";const C=JSON.parse('{"title":"Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch","description":"","frontmatter":{"title":"Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch","author":"teemwu","date":"2021/01/18 17:56","isPublished":true,"categories":["Javascript"],"tags":null},"headers":[{"level":1,"title":"Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch","slug":"promise-\u5982\u4F55\u9ED8\u8BA4\u5904\u7406-catch","link":"#promise-\u5982\u4F55\u9ED8\u8BA4\u5904\u7406-catch","children":[{"level":3,"title":"\u8D77\u56E0","slug":"\u8D77\u56E0","link":"#\u8D77\u56E0","children":[]},{"level":3,"title":"\u9700\u6C42","slug":"\u9700\u6C42","link":"#\u9700\u6C42","children":[]},{"level":3,"title":"\u89E3\u51B3","slug":"\u89E3\u51B3","link":"#\u89E3\u51B3","children":[]},{"level":3,"title":"\u53C2\u8003","slug":"\u53C2\u8003","link":"#\u53C2\u8003","children":[]}]}],"relativePath":"\u968F\u7B14/2021/Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch.md","lastUpdated":1670203393000}'),p={name:"\u968F\u7B14/2021/Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch.md"},o=l(`<h1 id="promise-\u5982\u4F55\u9ED8\u8BA4\u5904\u7406-catch" tabindex="-1">Promise \u5982\u4F55\u9ED8\u8BA4\u5904\u7406 catch <a class="header-anchor" href="#promise-\u5982\u4F55\u9ED8\u8BA4\u5904\u7406-catch" aria-hidden="true">#</a></h1><h3 id="\u8D77\u56E0" tabindex="-1">\u8D77\u56E0 <a class="header-anchor" href="#\u8D77\u56E0" aria-hidden="true">#</a></h3><p>\u4E3A\u4E86\u65B9\u4FBF\u7BA1\u7406\uFF0C\u5C01\u88C5\u5168\u5C40\u8BF7\u6C42\u65B9\u6CD5\u7684\u65F6\u5019\uFF0C\u9700\u8981\u5BF9\u5F02\u6B65\u8BF7\u6C42\u8FD4\u56DE\u503C\u8FDB\u884C\u7EDF\u4E00\u7684\u5F02\u5E38\u5904\u7406\uFF0C\u7B26\u5408\u7684\u503C\u5C31\u8D70 then \u8FDB\u884C\u8FD4\u56DE\uFF0C\u4E0D\u7B26\u5408\u7684\u6570\u636E\u8D70 catch \u8FDB\u884C\u8FD4\u56DE\u6216\u8005\u5904\u7406\u3002</p><h3 id="\u9700\u6C42" tabindex="-1">\u9700\u6C42 <a class="header-anchor" href="#\u9700\u6C42" aria-hidden="true">#</a></h3><p>1\u3001\u5F53\u6267\u884C Promise \u65B9\u6CD5\u51FA\u73B0\u5F02\u5E38\u65F6\u81EA\u52A8\u8C03\u7528 catch \u5E76\u6267\u884C\u5BF9\u5E94\u7684\u5904\u7406\u65B9\u6CD5 2\u3001\u9700\u8981\u5355\u72EC\u624B\u52A8\u5904\u7406 catch \u65F6\u53EF\u4EE5\u81EA\u884C\u624B\u52A8\u8C03\u7528 catch \u8FDB\u884C\u9519\u8BEF\u5904\u7406 3\u3001\u624B\u52A8\u8C03\u7528 catch \u65F6\u8981\u8986\u76D6\u6389\u9ED8\u8BA4\u6267\u884C\u7684 catch</p><p>\u6BD4\u5982</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> p </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MyPromise</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;">// promise \u65B9\u6CD5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">p</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">() </span><span style="color:#676E95;">// \u51FA\u9519\u65F6\u81EA\u52A8\u6267\u884C\u9ED8\u8BA4\u7684 catch</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">p</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{}</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">// \u624B\u52A8\u8C03\u7528 catch</span></span>
<span class="line"></span></code></pre></div><h3 id="\u89E3\u51B3" tabindex="-1">\u89E3\u51B3 <a class="header-anchor" href="#\u89E3\u51B3" aria-hidden="true">#</a></h3><p>\u6838\u5FC3\u65B9\u6CD5\u5982\u4E0B\uFF0Ccatch \u9ED8\u8BA4\u5C06\u62A5\u9519\u4FE1\u606F\u8FDB\u884C\u8F93\u51FA\u3002</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">RequestPromise</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">originalPromise</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">originalPromise</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_catchyPromise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_promise</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Error</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;">// every method but &#39;constructor&#39; from Promise.prototype</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">methods</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">then</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">catch</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">finally</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">for</span><span style="color:#F07178;"> (</span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">method</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">of</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">methods</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">method</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(...</span><span style="color:#A6ACCD;">args</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_promise</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">_promise</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">method</span><span style="color:#F07178;">](</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">args</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\u7531\u4E8E\u9879\u76EE\u4E2D\u4F7F\u7528\u4E86 flyio \uFF0C\u4E0B\u9762\u4F8B\u5B50\u57FA\u4E8E\u8BE5\u8BF7\u6C42\u5E93</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki"><code><span class="line"><span style="color:#676E95;">// post \u8BF7\u6C42\u5C01\u88C5</span></span>
<span class="line"><span style="color:#89DDFF;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> post </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">uri</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">RequestPromise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">Promise</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">resolve</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">reject</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">fly</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">uri</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">config</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">response</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">success</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">response</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">success</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">reject</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">response</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">reject</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">))</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;">// \u62A5\u9519\u65F6\u9ED8\u8BA4\u6267\u884C catch</span></span>
<span class="line"><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(URL)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;">// \u624B\u52A8\u5904\u7406\u62A5\u9519\u4FE1\u606F</span></span>
<span class="line"><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(URL)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">then</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#A6ACCD;">(</span><span style="color:#A6ACCD;">error</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;">// TODO</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><h3 id="\u53C2\u8003" tabindex="-1">\u53C2\u8003 <a class="header-anchor" href="#\u53C2\u8003" aria-hidden="true">#</a></h3><ul><li><a href="https://stackoverflow.com/a/39732825" target="_blank" rel="noreferrer">Define fallback catch for promise chain?</a></li></ul>`,14),e=[o];function c(t,r,F,y,D,A){return n(),a("div",null,e)}const h=s(p,[["render",c]]);export{C as __pageData,h as default};
